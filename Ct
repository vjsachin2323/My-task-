HLD â€“ AWS CloudTrail

1. Purpose

To provide governance, compliance, and audit visibility across AWS accounts by logging all management and data events into a centralized, immutable, and encrypted repository.

2. Audience
	â€¢	Cloud Security Team
	â€¢	Compliance & Audit Teams
	â€¢	DevOps Engineers

3. Introduction

AWS CloudTrail records account activity and API calls across AWS infrastructure. This design ensures:
	â€¢	Centralized multi-account logging.
	â€¢	S3 + KMS for encrypted storage.
	â€¢	Integration with CloudWatch for real-time alerts.
	â€¢	Validation for PCI 
DSS, HIPAA, and CIS benchmarks.

4. Architecture and Design
	â€¢	Centralized Organization Trail
	â€¢	Delegated Admin Account â†’ creates & manages org trail.
	â€¢	Logs all management & data events.
	â€¢	Storage
	â€¢	Logs delivered to centralized S3 bucket (enforced encryption with KMS).
	â€¢	Cross-region replication for durability.
	â€¢	Validation & Integrity
	â€¢	Enable log file validation for tamper detection.
	â€¢	Monitoring
	â€¢	Logs streamed to CloudWatch â†’ EventBridge for alerting.
	â€¢	Forwarded to Security Hub for correlation.

(Diagram suggestion: Org â†’ Member Accounts â†’ CloudTrail â†’ S3 + KMS â†’ CloudWatch/EventBridge â†’ SOC/SIEM)

5. List of Components & Services
	â€¢	AWS CloudTrail (Org Trail)
	â€¢	Amazon S3 (log bucket)
	â€¢	AWS KMS (bucket encryption)
	â€¢	Amazon CloudWatch (alerts, dashboards)
	â€¢	AWS EventBridge (alerts to SOC)
	â€¢	Security Hub / GuardDuty integration

6. Screenshots
	â€¢	CloudTrail dashboard showing active trail.
	â€¢	S3 bucket with logs + encryption enabled.
	â€¢	CloudWatch alarm for suspicious API calls.

7. Observability (Backup & Restore)
	â€¢	S3 logs backed with cross-region replication.
	â€¢	Lifecycle â†’ Glacier for long-term retention (7 years).
	â€¢	CloudTrail events queryable via Athena for auditing.

8. Common Services
	â€¢	Integrated with Security Hub (compliance).
	â€¢	Used by GuardDuty for threat intelligence.
	â€¢	Linked to Audit Account monitoring.

â¸»

ðŸ›  Implementation Steps

A. Create Organization Trail
	1.	In delegated Audit Account â†’ enable Organization Trail.

aws cloudtrail create-trail \
  --name OrgTrail \
  --s3-bucket-name central-audit-logs \
  --is-multi-region-trail \
  --is-organization-trail

2.	Apply to all accounts in AWS Organizations.

â¸»

B. Secure Storage
	1.	Create S3 bucket with encryption enforced.
	2.	Enable KMS key policy (only Audit account access).
	3.	Block public access.

Terraform example:
resource "aws_cloudtrail" "org" {
  name                          = "org-trail"
  s3_bucket_name                = aws_s3_bucket.cloudtrail.id
  is_multi_region_trail         = true
  include_global_service_events = true
  enable_log_file_validation    = true
}
C. Monitoring & Alerts
	â€¢	Stream CloudTrail to CloudWatch Logs.
	â€¢	Create alarms for critical API calls (e.g., DeleteTrail, StopLogging, DisableKey).
	â€¢	EventBridge â†’ SNS/Lambda â†’ SOC or SIEM integration.
Do you also want me to draft a Draw.io diagram for CloudTrail (Org accounts â†’ Trail â†’ S3+KMS â†’ CloudWatch/EventBridge â†’ SOC)?
